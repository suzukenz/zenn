---
title: "å€‹äººçš„Excelèª­ã¿å–ã‚Šã®å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³"
emoji: "ðŸ¤¯"
type: "tech"
topics:
  - "excel"
  - "spreadsheet"
published: true
published_at: "2023-12-23 22:16"
---

ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã¨ã—ã¦æ¥­å‹™ã‚·ã‚¹ãƒ†ãƒ ã‚’é–‹ç™ºã—ã¦ã„ã‚‹ã¨ã€Excelãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿å–ã£ã¦ä½•ã‹ã—ãªã„ã¨ã„ã‘ãªã„ã‚±ãƒ¼ã‚¹ãŒç¨€ã«ã‚ˆãã‚ã‚Šã¾ã™ã€‚

ã—ã‹ã—ã€ã‚¨ãƒ³ãƒ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒç·¨é›†ã™ã‚‹Excelãƒ•ã‚¡ã‚¤ãƒ«ã¯ã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®ãƒ©ã‚¤ãƒ•ã‚µã‚¤ã‚¯ãƒ«ã¨ã¯ç•°ãªã‚‹ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆãŒå¤‰ã‚ã£ãŸã‚Šã€ãã‚‚ãã‚‚ãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆã‚’ç ´å£Šã—ã¦å…¥åŠ›ã•ã‚ŒãŸã‚Šã™ã‚‹ã“ã¨ãŒã‚ã‚Šã€èª­ã¿å–ã‚Šæ©Ÿèƒ½ã‚’ãƒ¡ãƒ³ãƒ†ãƒŠãƒ–ãƒ«ã«å®Ÿè£…ã™ã‚‹ã®ã¯ãªã‹ãªã‹é›£ã—ã„ã§ã™ã€‚

ä»Šå›žã¯ã€è‡ªåˆ†ãŒä½•åº¦ã‹Excelèª­ã¿å–ã‚Šã‚’å®Ÿè£…ã—ãŸçµŒé¨“ã‹ã‚‰ã€å®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’æ•´ç†ã—ã¦ã¿ã¾ã™ã€‚  
â€»éŠ€ã®å¼¾ä¸¸çš„ãªè§£æ±ºç­–ã¯æ€ã„ã¤ã„ã¦ãŠã‚‰ãšã€ãƒˆãƒ¬ãƒ¼ãƒ‰ã‚ªãƒ•ã§å®Ÿè£…ã™ã‚‹æ„Ÿã˜ã¨è€ƒãˆã¦ã„ã¾ã™ã€‚

ã‚µãƒ³ãƒ—ãƒ«ã§TypeScriptã®æ“¬ä¼¼ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã¾ã™ãŒã€ã‚ãã¾ã§ã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã€ç‰¹å®šã®ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ï¼ˆExcelã€Googleã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆã€OpenOfficeãªã©ï¼‰ã§ãã®ã¾ã¾ä½¿ãˆã‚‹ã‚‚ã®ã§ã¯ãªã„ã§ã™

## ãƒ‘ã‚¿ãƒ¼ãƒ³1. ã‚»ãƒ«ã®ä½ç½®ã‚’å®šæ•°ã§ç®¡ç†ã™ã‚‹

å®Ÿè£…çš„ã«æœ€ã‚‚ã‚·ãƒ³ãƒ—ãƒ«ã§ç°¡å˜ã€‚
ã‚»ãƒ«ã®ä½ç½®ãŒå¤‰ã‚ã£ãŸå ´åˆã€å®šæ•°ã‚’ä¿®æ­£ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚ã®ã§ã€è¡Œãƒ»åˆ—ã®å¤‰æ›´ãŒæ¿€ã—ã„å ´åˆã«ã¯å‘ã‹ãªã„ã€‚

```ts
const NAME_CELL = 'A1';
const name = sheet.get(NAME_CELL);

// æ•°å€¤ã§ç®¡ç†ã™ã‚‹ã‚±ãƒ¼ã‚¹ã‚‚ã€‚
const NAME_CELL = {
    row: 1,
    column: 1,
};
const name = sheet.get(NAME_CELL.row, NAME_CELL.column);
```

### [æ´¾ç”Ÿ] ã‚»ãƒ«ã®ä½ç½®ã‚’æ›¸ã„ã¦ã‚ã‚‹ã‚»ãƒ«ã®ä½ç½®ã‚’å®šæ•°ã§ç®¡ç†ã™ã‚‹

ï¼ˆã±ã£ã¨è¦‹ä½•ã‚’è¨€ã£ã¦ã‚‹ã‚“ã ã‚ã†ãƒ»ãƒ»ãƒ»ã§ã™ãŒã€‚ï¼‰
ã“ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã ã¨ã€ãƒ‡ãƒ¼ã‚¿ã‚»ãƒ«ã®ä½ç½®ãŒå¤‰ã‚ã£ãŸå ´åˆã«ã€ã‚·ãƒ¼ãƒˆã‚’ä¿®æ­£ã™ã‚‹ã ã‘ã§æ¸ˆã‚€ã®ã§ã€ã‚¨ãƒ³ã‚¸ãƒ‹ã‚¢ã‚’ä»‹ã•ãšã«ãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆã‚’ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹ã§ãã‚‹ã€‚ã€Œã‚·ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆã®å®‰å®šåº¦ã¯ä½Žã„ãŒã€èª­ã¿å–ã‚‹ã¹ãæƒ…å ±ã¯å®‰å®šã—ã¦ã„ã‚‹ã€å ´åˆã«ä½¿ãˆã‚‹ã€‚

```ts
// ã“ã®ã‚»ãƒ«ã«ã¯ã€Name ã®ã‚»ãƒ«ã®ä½ç½® ("B10" ãªã©)ãŒæ›¸ã‹ã‚Œã¦ã„ã‚‹
const NAME_REFERENCE_CELL = 'A1'; 

const nameRef = sheet.get(NAME_REFERENCE_CELL);
const name = sheet.get(nameRef);
```

## ãƒ‘ã‚¿ãƒ¼ãƒ³2. é …ç›®åã‚’å®šæ•°ã§ç®¡ç†ã—ã€ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œã‚’æ¤œç´¢ã—ã¦é …ç›®ã”ã¨ã®åˆ—ç•ªå·ã‚’å–å¾—ãƒ»ä¿æŒã™ã‚‹

ãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆãŒ(ã‚ã‚‹ç¨‹åº¦)å¤‰ã‚ã£ã¦ã‚‚ã€é …ç›®åãŒå¤‰ã‚ã‚‰ãªã‘ã‚Œã°èª­ã¿å–ã‚Œã‚‹ã€‚
å˜ç´”ãªãƒ‡ãƒ¼ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚ˆã†ãªã€ãƒ˜ãƒƒãƒ€ãƒ¼ + ãƒ‡ãƒ¼ã‚¿è¡Œã®ãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆã«å‘ã„ã¦ã„ã‚‹ã€‚
ãƒ˜ãƒƒãƒ€ãƒ¼è¡Œã®ãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆãŒè¤‡é›‘ï¼ˆè¤‡æ•°è¡Œã«è·¨ã£ãŸã‚Šã€çµåˆã•ã‚ŒãŸã‚Šï¼‰ã—ã¦ã„ã‚‹ã¨ã€å®Ÿè£…ã‚‚è¤‡é›‘ã«ãªã‚‹ã€‚

```ts
const NAME_COLUMN_NAME = 'åå‰';
const AGE_COLUMN_NAME = 'å¹´é½¢';
const ADDRESS_COLUMN_NAME = 'ä½æ‰€';

type Columns = {
    name: number;
    age: number;
    address: number;
};

const getColumns = (headerRow: string[]): Columns => {
    const columns: Columns = {
        name: -1,
        age: -1,
        address: -1,
    };
    headerRow.forEach((cell, index) => {
        switch (cell) {
            case NAME_COLUMN_NAME:
                columns.name = index;
                break;
            case AGE_COLUMN_NAME:
                columns.age = index;
                break;
            case ADDRESS_COLUMN_NAME:
                columns.address = index;
                break;
        }
    });
    return columns;
};

const rows = sheet.getRows();
const columns = getColumns(rows[0]);
for (let i = 1; i < rows.length; i++) {
    const row = rows[i];
    const name = row[columns.name];
    const age = row[columns.age];
    const address = row[columns.address];
    console.log(name, age, address);
}
```

## ãƒ‘ã‚¿ãƒ¼ãƒ³3. é …ç›®åã¨ã€ãƒ‡ãƒ¼ã‚¿ã‚»ãƒ«ã®ç›¸å¯¾ä½ç½®ã‚’å®šæ•°ã§ç®¡ç†ã™ã‚‹

å…ˆã»ã©ã¨åŒã˜ãã€ã‚·ãƒ¼ãƒˆã®ãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆãŒå¤‰æ›´ã•ã‚Œã¦ã‚‚ã€é …ç›®åãŒå¤‰ã‚ã‚‰ãªã‘ã‚Œã°ã‚ã‚‹ç¨‹åº¦èª­ã¿å–ã‚Œã‚‹ã€‚
ãŸã ã—ã€ç›¸å¯¾ä½ç½®ã‚’å®šç¾©ã™ã‚‹ã®ã§ã€ä»–ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã«æ¯”ã¹ã¦ãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆå¤‰æ›´ã«å¼±ã„ã€‚

ãƒ‡ãƒ¼ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«ã®ã‚ˆã†ãªå®šåž‹ãƒ•ã‚©ãƒ¼ãƒžãƒƒãƒˆã§ã¯ãªã„ã€ã‚·ãƒ¼ãƒˆå…¨ä½“ã‹ã‚‰ãƒ‡ãƒ¼ã‚¿ã‚»ãƒ«ã‚’æŽ¢ã™å¿…è¦ãŒã‚ã‚‹å ´åˆã«å‘ã„ã¦ã„ã‚‹ã€‚

ã¾ãŸé…åˆ—ã®å‚ç…§ã‚¨ãƒ©ãƒ¼ã‚’è€ƒæ…®ã—ãŸã‚Šã€åŠ¹çŽ‡ã‚ˆãä½•åº¦ã‚‚èª­ã¿å–ã‚ŠãŸã‹ã£ãŸã‚Šã™ã‚‹å ´åˆã€å®Ÿè£…ãƒ ã‚ºãªã„ãƒ»ãƒ»ãƒ»ï¼Ÿã¨ã„ã†ãƒ‡ãƒ¡ãƒªãƒƒãƒˆã‚‚ã‚ã‚‹

```ts
type DataCellRef = {
    // é …ç›®å
    indicator: string;
    // ãƒ‡ãƒ¼ã‚¿ã‚»ãƒ«ã®è¡Œæ–¹å‘ã®ç›¸å¯¾ä½ç½®
    rowOffset: number;
    // ãƒ‡ãƒ¼ã‚¿ã‚»ãƒ«ã®åˆ—æ–¹å‘ã®ç›¸å¯¾ä½ç½®
    columnOffset: number;
};

const nameDataRef: DataCellRef = {
    indicator: 'åå‰',
    rowOffset: 1,
    columnOffset: 0,
};

function matchDataRef(cellValue: string, dataRef: DataCellRef): boolean {
    return cellValue === dataRef.indicator;
}


const rows = sheet.getRows();

for (let i = 0; i < rows.length; i++) {
    for (let j = 0; j < rows[i].length; j++) {
        const cell = rows[i][j]; // æœ¬æ¥ã¯out of rangeã®è€ƒæ…®ã¨ã‹ãŒå¿…è¦
        if (matchDataRef(cell, nameDataRef)) {
            const name = rows[i + nameDataRef.rowOffset][j + nameDataRef.columnOffset];
            console.log(name);
        }
    }
}
```

æ´¾ç”Ÿã¨ã—ã¦ã€ã“ã‚Œã‚’ãƒ‘ã‚¿ãƒ¼ãƒ³(2.)ã¨çµ„ã¿åˆã‚ã›ãŸã‚Šã™ã‚‹ã€‚ï¼ˆã‚·ãƒ¼ãƒˆã®ã©ã“ã«ãƒ‡ãƒ¼ã‚¿ãƒ†ãƒ¼ãƒ–ãƒ«ãŒã‚ã‚‹ã®ã‹ã‚ã‹ã‚‰ãªã„å ´åˆãªã©ã€‚å®Ÿè£…ãƒ ã‚ºãªã„ãƒ»ãƒ»ãƒ»ï¼Ÿï¼‰

## ãŠã‚ã‚Šã«

è‡ªåˆ†ã®çµŒé¨“å€¤ã ã¨ä»¥ä¸Šã¨ãªã‚Šã¾ã™ã€‚
ã¿ãªã•ã‚“ã®Excelèª­ã¿å–ã‚Šå®Ÿè£…ãƒ‘ã‚¿ãƒ¼ãƒ³~~è‹¦åŠ´è©±~~ã‚‚çŸ¥ã‚ŠãŸã„ã§ã™ã€‚ï¼ˆã“ã‚ŒãŒä¸€ç•ªæ›¸ããŸã‹ã£ãŸã“ã¨ï¼‰
